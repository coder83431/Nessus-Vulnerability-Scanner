<p align="center">
<img src="https://imgur.com/DYSGRml.png"

" alt="osTicket logo"/>
</p>

<h1> Credentializd Scanning Of Vulnerable Windows 10 VM Host Using Nessus </h1>
In this tutorial, we will perform vulnerability scans with OpenVAS against an insecure host that will be created in Microsoft Azure. Credential and non-credential scans will be performed and their report results will be compared. Remediations will then be performed against some of the identified vulnerabilities..<br />


<h2>Environments and Technologies Used</h2>

- VMware Workstation Player
- Remote Desktop
- Windows Registry
-Nessus Scanner

<h2>Operating Systems Used </h2>

- Windows 10</b> (version 22H2)

<h2>List of Prerequisites</h2>

-Windows 10 VM
- Nessus Vulnerability Scanner
- VMware Workstation Player

<h2>Installation Steps</h2>




<p>
<img src = "https://imgur.com/GfDknOY.png" " height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
 <p>
1. In Microsoft Azure, go to "Marketplace" and search for OpenVAS.
</p>                                                                                                    
                                                                                                     
<p>
<img src= "https://imgur.com/uR2vRL3.png" " height="80%" width="80%" alt="Disk Sanitization Steps" />
</p>

<p>
                                                                                                 
                                                                                                 
                                                                                                 
2. Create the OpenVAS VM in Microsoft Azure.
</p>
<br />

<p>
<img src="https://imgur.com/BUtNtP3.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
3. SSH into OpenVAS using Powershell. You should enter the command "sssh [vm username]@[public IP address of vm]." Once the command is entered, you will receive the username and password in the command line.
</p>
<br />

<p>
<img src="https://imgur.com/8DbMfvu.png" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
4. The command line will also give you the URL that will take you to the login page of OpenVAS. Use the username and password that was in the command line to log in.
</p>
<br />

<p>
<img src="https://imgur.com/aIrwKJo.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
5. Create a Windows 10 VM in Microsoft Azure. Make sure that the VM has the same resource group as the OpenVAS VM. You can then RDP into the VM.
</p>
<br />

<p>
6. We will now configure the Windows 10 VM to become more vulnerable. This will be accomplished by installing insecure software. Install a Firefox Setup 97.0b5, vlc-1.1.7-win32, and 10.0_AdbeRdr1000_en_US_1_. 
These are all old versions of the software. The VM can now be restarted for the changes to take place.
</p>
<br />

<p>
<img src="https://imgur.com/d6QbjdD.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
7. The uncredentialed scan can now be configured in OpenVAS. Login to OpenVAS → Assets → Hosts → New Host. You can now create a new Target and choose the created host as the target.

</p>
<br />

<p>
<img src="https://imgur.com/BAGIVVa.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
8. Create a new task and configure the task to use the previously created target.
</p>
<br />

<p>
<img src="https://i.imgur.com/U0zZqC1.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>
<p>
9. Once the task is created, start the scan. When the scan is complete, click on the date under "Last Report" to see the results.
 
</p>
<br />

<p>

<img src="https://imgur.com/7PfWjwe.png" alt="Firewall Rules"/>
</p>
<p>
</p>
<p>
10. Configurations can now be made within the Windows 10 VM so that a credentialed scan can be conducted. RDP into the Windows VM and disable the Windows firewall and the user account controls.
</p>
<br />

<p>
<img src="https://imgur.com/GshfRyM.png" height="80%" width="80%" alt="Remote Registry"/>
</p>
<p>
11. Enable the remote registry and set the registry key. 

Launch Registry Editor (regedit.exe) in “Run as administrator” mode and grant Admin Approval, if requested
Navigate to HKEY_LOCAL_MACHINE hive. Then open SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System key.
Create a new DWORD (32-bit) value with the following properties:  Name: LocalAccountTokenFilterPolicy  Value: 1
You can now close the Registry Editor and restart the vm.

</p>


<p>

</p>
<p>
12. Configure the OpenVas scanner to conduct credentialed SMB scanning.
</p>




<p>

</p>
<p>
13. Conduct the credential OpenVas scan against the vulnerable Windows VM host. Compare the report results between the uncredentialed scan and the credentialized scan.
</p>
<br />



<p>

</p>
<p>
14. Remediate some of the vulnerabilities from the credentialed scan. This can be done by going back into the Windows VM and uninstalling the outdated software that was previously installed. When you run the credentialed scan again, you should notice that there is a lower severity level for the identified vulnerabilities.
</p>
<br />


